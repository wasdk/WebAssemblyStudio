{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/message.ts","webpack:///./src/worker.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","WorkerCommand","__webpack_exports__","_message__WEBPACK_IMPORTED_MODULE_0__","async","loadBinaryen","Binaryen","importScripts","loadWabt","wabt","self","global","Twiggy","optimizeWasmWithBinaryen","data","readBinary","Uint8Array","optimize","Promise","resolve","emitBinary","validateWasmWithBinaryen","validate","createWasmCallGraphWithBinaryen","old","print","ret","x","runPasses","convertWasmToAsmWithBinaryen","emitAsmjs","disassembleWasmWithBinaryen","emitText","assembleWatWithBinaryen","parseText","disassembleWasmWithWabt","readWasm","readDebugNames","generateNames","applyNames","toText","foldExprs","inlineExport","assembleWatWithWabt","parseWat","resolveNames","toBinary","log","write_debug_names","buffer","twiggyWasm","opts","wasm_bindgen","Items","Top","Paths","Monos","Dominators","loadTwiggy","items","parse","md","new","top","JSON","ignoreCount","forEach","entry","shallow_size_percent","shallow_size","toFixed","retainedSizePercentIgnoreThreshold","printDominator","dominator","depth","prefix","retained_size","retained_size_percent","children","child","dominators","onmessage","e","fn","[object Object]","OptimizeWasmWithBinaryen","ValidateWasmWithBinaryen","CreateWasmCallGraphWithBinaryen","ConvertWasmToAsmWithBinaryen","DisassembleWasmWithBinaryen","AssembleWatWithBinaryen","DisassembleWasmWithWabt","AssembleWatWithWabt","TwiggyWasm","command","message","Error","assert","request","response","id","payload","success","postMessage","undefined","processMessage"],"mappings":"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","file":"worker.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 51);\n","/* Copyright 2018 Mozilla Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nexport enum WorkerCommand {\n  OptimizeWasmWithBinaryen,\n  ValidateWasmWithBinaryen,\n  CreateWasmCallGraphWithBinaryen,\n  ConvertWasmToAsmWithBinaryen,\n  DisassembleWasmWithBinaryen,\n  AssembleWatWithBinaryen,\n  DisassembleWasmWithWabt,\n  AssembleWatWithWabt,\n  TwiggyWasm\n}\n\n/**\n * Worker requests.\n */\nexport interface IWorkerRequest {\n  id: number;\n  payload: ArrayBuffer | string;\n  command: WorkerCommand;\n}\n\n/**\n * Worker response.\n */\nexport interface IWorkerResponse {\n  id: number;\n  payload: ArrayBuffer | string | Object;\n  success: boolean;\n}\n","/* Copyright 2018 Mozilla Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nimport { IWorkerRequest, WorkerCommand, IWorkerResponse } from \"./message\";\n\ndeclare var importScripts: Function;\n\nfunction assert(c: any, message?: string) {\n  if (!c) {\n    throw new Error(message);\n  }\n}\n\ndeclare interface BinaryenModule {\n  optimize(): any;\n  validate(): any;\n  emitBinary(): ArrayBuffer;\n  emitText(): string;\n  emitAsmjs(): string;\n  runPasses(passes: string []): any;\n}\n\ndeclare var Binaryen: {\n  readBinary(data: Uint8Array): BinaryenModule;\n  parseText(data: string): BinaryenModule;\n  print(s: string): void;\n  printErr(s: string): void;\n};\n\ndeclare var wabt: {\n  ready: Promise<any>\n  readWasm: Function;\n  parseWat: Function;\n};\n\nasync function loadBinaryen() {\n  if (typeof Binaryen === \"undefined\") {\n    importScripts(\"../lib/binaryen.js\");\n  }\n}\n\nasync function loadWabt() {\n  if (typeof wabt === \"undefined\") {\n    (self as any).global = self; // Wabt installs itself on the global object.\n    importScripts(\"../lib/wabt.js\");\n  }\n}\n\nlet Twiggy: any = null;\ndeclare var wasm_bindgen: any;\n\nasync function loadTwiggy() {\n  if (!Twiggy) {\n    importScripts(\"../lib/twiggy_wasm_api.js\");\n    await wasm_bindgen(\"../lib/twiggy_wasm_api_bg.wasm\");\n    Twiggy = {\n      Items: wasm_bindgen.Items,\n      Top: wasm_bindgen.Top,\n      Paths: wasm_bindgen.Paths,\n      Monos: wasm_bindgen.Monos,\n      Dominators: wasm_bindgen.Dominators\n    };\n  }\n}\n\nonmessage = (e: {data: IWorkerRequest}) => {\n  const fn = {\n    [WorkerCommand.OptimizeWasmWithBinaryen]: optimizeWasmWithBinaryen,\n    [WorkerCommand.ValidateWasmWithBinaryen]: validateWasmWithBinaryen,\n    [WorkerCommand.CreateWasmCallGraphWithBinaryen]: createWasmCallGraphWithBinaryen,\n    [WorkerCommand.ConvertWasmToAsmWithBinaryen]: convertWasmToAsmWithBinaryen,\n    [WorkerCommand.DisassembleWasmWithBinaryen]: disassembleWasmWithBinaryen,\n    [WorkerCommand.AssembleWatWithBinaryen]: assembleWatWithBinaryen,\n    [WorkerCommand.DisassembleWasmWithWabt]: disassembleWasmWithWabt,\n    [WorkerCommand.AssembleWatWithWabt]: assembleWatWithWabt,\n    [WorkerCommand.TwiggyWasm]: twiggyWasm\n  }[e.data.command];\n  assert(fn, `Command ${e.data.command} not found.`);\n  processMessage(e.data, fn);\n};\n\nasync function processMessage(request: IWorkerRequest, fn: Function) {\n  const response: IWorkerResponse = {\n    id: request.id,\n    payload: null,\n    success: true\n  };\n  try {\n    response.payload = await fn(request.payload);\n  } catch (e) {\n    response.payload = {\n      message: e.message\n    };\n    response.success = false;\n  }\n  postMessage(response, undefined);\n}\n\nasync function optimizeWasmWithBinaryen(data: ArrayBuffer): Promise<ArrayBuffer> {\n  await loadBinaryen();\n  const module = Binaryen.readBinary(new Uint8Array(data));\n  module.optimize();\n  return Promise.resolve(module.emitBinary());\n}\n\nasync function validateWasmWithBinaryen(data: ArrayBuffer): Promise<number> {\n  await loadBinaryen();\n  const module = Binaryen.readBinary(new Uint8Array(data));\n  return Promise.resolve(module.validate());\n}\n\nasync function createWasmCallGraphWithBinaryen(data: ArrayBuffer): Promise<string> {\n  await loadBinaryen();\n  const module = Binaryen.readBinary(new Uint8Array(data));\n  const old = Binaryen.print;\n  let ret = \"\";\n  Binaryen.print = (x: string) => { ret += x + \"\\n\"; };\n  module.runPasses([\"print-call-graph\"]);\n  Binaryen.print = old;\n  return Promise.resolve(ret);\n}\n\nasync function convertWasmToAsmWithBinaryen(data: ArrayBuffer): Promise<string> {\n  await loadBinaryen();\n  const module = Binaryen.readBinary(new Uint8Array(data));\n  module.optimize();\n  return Promise.resolve(module.emitAsmjs());\n}\n\nasync function disassembleWasmWithBinaryen(data: ArrayBuffer): Promise<string> {\n  await loadBinaryen();\n  const module = Binaryen.readBinary(new Uint8Array(data));\n  return Promise.resolve(module.emitText());\n}\n\nasync function assembleWatWithBinaryen(data: string): Promise<ArrayBuffer> {\n  await loadBinaryen();\n  const module = Binaryen.parseText(data);\n  return Promise.resolve(module.emitBinary());\n}\n\nasync function disassembleWasmWithWabt(data: ArrayBuffer): Promise<string> {\n  await loadWabt();\n  const module = wabt.readWasm(data, { readDebugNames: true });\n  module.generateNames();\n  module.applyNames();\n  return Promise.resolve(module.toText({ foldExprs: false, inlineExport: true }));\n}\n\nasync function assembleWatWithWabt(data: string): Promise<ArrayBuffer> {\n  await loadWabt();\n  const module = wabt.parseWat(\"test.wat\", data);\n  module.resolveNames();\n  module.validate();\n  return Promise.resolve(module.toBinary({ log: true, write_debug_names: true }).buffer);\n}\n\ninterface IDominator {\n  children: IDominator [];\n  name: string;\n  retained_size: number;\n  retained_size_percent: number;\n  shallow_size: number;\n  shallow_size_percent: number;\n}\n\nasync function twiggyWasm(data: ArrayBuffer): Promise<string> {\n  await loadTwiggy();\n  let opts;\n  const items = Twiggy.Items.parse(new Uint8Array(data));\n\n  let md = \"# Twiggy Analysis\\n\\nTwiggy is a code size profiler, learn more about it [here](https://github.com/rustwasm/twiggy).\\n\\n\";\n\n  // Top\n  opts = Twiggy.Top.new();\n  const top: Array<{name: string, shallow_size: number, shallow_size_percent: number}> = JSON.parse(items.top(opts));\n\n  md += \"## Top\\n\\n\";\n  md += \"| Shallow Bytes | Shallow % | Item |\\n\";\n  md += \"| ------------: | --------: | :--- |\\n\";\n\n  let ignoreCount = 0;\n  const shallowSizePercentIgnoreThreshold = 0.1;\n  top.forEach(entry => {\n    if (entry.shallow_size_percent >= shallowSizePercentIgnoreThreshold) {\n      md += `| ${entry.shallow_size} | ${entry.shallow_size_percent.toFixed(2)} | \\`${entry.name}\\` |\\n`;\n    } else {\n      ignoreCount ++;\n    }\n  });\n\n  if (ignoreCount) {\n    md += `\\n### Note:\\n${ignoreCount} items had a shallow size percent less than ${shallowSizePercentIgnoreThreshold} and were not listed above.\\n`;\n  }\n\n  // Paths\n  // md += \"\\n\\n# Paths\\n\\n\";\n  // opts = Twiggy.Paths.new();\n  // const paths = JSON.parse(items.paths(opts));\n\n  // Monos\n  // md += \"\\n\\n# Monos\\n\\n\";\n  // opts = Twiggy.Monos.new();\n  // opts.set_max_generics(10);\n  // opts.set_max_monos(10);\n  // const monos = JSON.parse(items.monos(opts));\n\n  md += \"\\n\\n## Dominators\\n\\n\";\n  md += \"| Retained Bytes | Retained % | Dominator Tree |\\n\";\n  md += \"| ------------: | --------: | :--- |\\n\";\n\n  // Dominators\n  const retainedSizePercentIgnoreThreshold = 0.1;\n  ignoreCount = 0;\n  opts = Twiggy.Dominators.new();\n  const dominator: IDominator = JSON.parse(items.dominators(opts));\n  function printDominator(dominator: IDominator, depth: number) {\n    let prefix = \"\";\n    for (let i = 0; i < depth - 1; i++) {\n      prefix += \"   \";\n    }\n    if (depth) {\n      prefix += \"⤷ \";\n    }\n    md += `| ${dominator.retained_size} | ${dominator.retained_size_percent.toFixed(2)} | \\`${prefix + dominator.name}\\` |\\n`;\n    if (dominator.children) {\n      dominator.children.forEach(child => {\n        if (child.retained_size_percent >= retainedSizePercentIgnoreThreshold) {\n          printDominator(child, depth + 1);\n        } else {\n          ignoreCount ++;\n        }\n      });\n    }\n  }\n  printDominator(dominator, 0);\n  if (ignoreCount) {\n    md += `\\n### Note:\\n${ignoreCount} items had a retained size percent less than ${retainedSizePercentIgnoreThreshold} and were not listed above.\\n`;\n  }\n  return Promise.resolve(md);\n}\n"],"sourceRoot":""}